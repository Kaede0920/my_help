\chapter{基本的事項}\label{ux57faux672cux7684ux4e8bux9805}

\section{my\_help}\label{my_help}

\subsection{目的}\label{ux76eeux7684}

my
helpとは，ユーザー独自のマニュアルを作成することができるユーザメモソフトである．これは，terminalだけを用いて簡単に起動，編集，削除などをすることができるため，非常に便利である．さらに，そのマニュアルは自分ですぐに編集，参照することができるので，メモとしての機能も果たし
ている．これにより，プログラミング初心者が，頻繁に使うコマンドやキーバインドなどをいちいちweb
browserを立ち上げて調べるのではなく，terminal上で即座に取得できるため，プログラム開発を集中することが期待される．

また，正式なマニュアルは英語で書かれていることが多く，初心者には理解するのが困難である．my\_helpを使用すれば，自分なりのマニュアルを作成することができるので，仕様を噛み砕いて理解することができる．tarminal上でいつでもメモを参照できるため，どこにメモをしたかを忘れるリスクも軽減される

しかし，my
helpにある問題のうちの一つとして挙げられるのがサブコマンドの記述法である．

\subsection{コマンド}\label{ux30b3ux30deux30f3ux30c9}

clean exeディレクトリの中のファイルを全て削除する．

delete NAME NAMEのメモを削除する．

edit NAME NAMEのメモを編集する．

help COMAND COMANDのヘルプを表示する．

init NAME my helpの雛形をNAMEにコピーする．

install\_local
gemがそのPC内にあるとき，そのgemをコマンドとして実行できるようにする．rake
buildでパッケージ化されたヘルプを人に渡して，渡されたものをその人がinstall
localすることでパッケージ化されているヘルプを展開する．

list メモのリストを表示する

make 新しいメモを作成する．

version my\_helpのバージョンを表示する．

\section{optparse}\label{optparse}

ここにはoptparseの説明を書く．

今回の研究対象のmy
helpは，optparseで実装されている．optparseはRubyでコマンドラインのオプションを操作するためのライブラリである．optparseが操作するオプションは，下記のonメソッドで設定する．

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{def}\NormalTok{ execute}
  \OtherTok{@argv}\NormalTok{ << ’--help’ }\KeywordTok{if} \OtherTok{@argv}\NormalTok{.size==}\DecValTok{0}
\NormalTok{  command_parser = }\DataTypeTok{OptionParser}\NormalTok{.new }\KeywordTok{do}\NormalTok{ |opt|}
\NormalTok{    opt.on(’-v’, ’--version’,’show␣program␣}\DataTypeTok{Version}\NormalTok{.’ ) \{ |v|}
\NormalTok{      opt.version = }\DataTypeTok{MyHelp}\NormalTok{::}\DataTypeTok{VERSION}
\NormalTok{      puts opt.ver}
\NormalTok{    \}}
\NormalTok{    opt.on(’-l’, ’--list’, ’list␣specific␣helps’)\{list_helps\}}
    \CommentTok{#中略}
  \KeywordTok{end}
  \CommentTok{#中略}
\KeywordTok{end}
    
\KeywordTok{def}\NormalTok{ list_helps}
\CommentTok{#中略}
\KeywordTok{end}
\CommentTok{#後略}
\end{Highlighting}
\end{Shaded}

第１引数はショートオプションで，-aや-dのような形で設定する．同様にして，第２引数はロングオプションを表し，-\/-addや-\/-deleteのように，第３引数はそのオプションの説明文で，helpで表示される説明文を設定する．後ろのブロックには，そのオプションが指定された場合に実行されるコードを記述する
{[}2{]}．しかしこのライブラリでは自然言語に近い，ハイフンなしのサブコマンドを実装するには相当な書き換えが必要となる．

メソッドの引数でオプションを定義し，引数が指定された時の処理をブロックで記述する．ブロックの引数にはオプションが指定されたことを示すtrueが渡される．onメソッドが呼ばれた時点ではオプションは実行されず，定義されるだけである．parseが呼ばれた際，コマンドラインにオプションが登録されていれば実行される．

オプション定義の際，スペースの後に任意の文字を追加すると，そのオプションは引数を受け取るオプションになる．その文字に{[}{]}をつけることで引数は必須でなくなる．また引数がハイフンで始まる場合，オプションとの間にハイフンを２つ挟むことで引数として認識される．

helpとversionのサブコマンドはデフォルトで作成される．

参考になりそうなところを見てoptparseについての説明．
長所短所．thorの長所短所と比較して図．あらかじめ描いてもいい．

\section{thor}\label{thor}

上と同じ．

本研究ではoptparseの代わりのライブラリとしてThorの採用を検討する．Thorは，コマンドラインツールの作成を支援するライブラリであり，gitやbundlerのようにサブコマンドを含むコマンドラインツールを簡単に作成することができる
{[}3{]}．Thorには以下のような特徴がある． 1.
コマンドラインオプションのパーズやサブコマンドごとのヘルプを作るなどの面倒な作業を簡単にこなすことができ，手早くビルドツールや実行可能なコマンドを作成できる
{[}4{]}． 1. 特殊なDSL(Domain Specific
Language)を使わずにメソッドを定義することで処理を記述するため，テストを行いやすい
{[}4{]}． 1.
optparseでは作成することが困難な，マイナスを伴わない(自然言語に近い)サブコマンドを実装することが可能である．

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{desc }\StringTok{'list, --list'}\NormalTok{, }\StringTok{'list specific helps'}
\NormalTok{    map }\StringTok{"--list"}\NormalTok{ => }\StringTok{"list"}
    \KeywordTok{def}\NormalTok{ list}
\NormalTok{      print }\StringTok{"Specific help file:\textbackslash{}n"}
\NormalTok{      local_help_entries.each\{|file|}
\NormalTok{        file_path=}\DataTypeTok{File}\NormalTok{.join(}\OtherTok{@local_help_dir}\NormalTok{,file)}
\NormalTok{        help = }\DataTypeTok{YAML}\NormalTok{.load(}\DataTypeTok{File}\NormalTok{.read(file_path))}
\NormalTok{        print }\StringTok{"  }\OtherTok{#\{}\NormalTok{file}\OtherTok{\}}\StringTok{\textbackslash{}t:}\OtherTok{#\{}\NormalTok{help[}\StringTok{:head}\NormalTok{][}\DecValTok{0}\NormalTok{]}\OtherTok{\}}\StringTok{\textbackslash{}n"}
\NormalTok{      \}}
    \KeywordTok{end}
\end{Highlighting}
\end{Shaded}

optparseではonメソッドでコマンドの登録を行い，その後のdefでコマンドの振る舞いを定義している．それに対してThorは登録と定義を同時に行うことができるのでコードが書きやすい．また，Thorを継承したクラスのパブリックメソッドがそのままコマンドになるので非常に簡単にコマンドを作成することが可能である．また，Thorはコマンドを作成した時点で，自動的にヘルプを生成してくれルため，楽である．コマンドの指定なしで実行するとヘルプを表示する．

長所短所と説明．optparseと同じく．
なんでthorなのか，動機，根拠．サブコマンドとか． 論理的に言えるように．

Thorではクラスを作ったらメソッドがそのままサブコマンドの処理になるので便利．optparseではそれができないので不便．

    \section{awesome}\label{awesome}

Command line applicationのoptionの記述方法には幾つもの流儀があるようで
何らかの標準があるわけではない．
しかし，それら全てに対応することはできず，なんらかの
基準に従ってオプション記法を解釈する必要がある．

ここでは， "Build awesome command-line application in ruby 2"に従って
option記法と用語をまとめておく．

    